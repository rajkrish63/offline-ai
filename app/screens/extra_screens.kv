#:import dp kivy.metrics.dp
#:import sp kivy.metrics.sp
#:import parse_color kivy.parser.parse_color

<VoiceScreen>:
    MDBoxLayout:
        orientation: "vertical"
        padding: dp(12)
        spacing: dp(10)
        canvas.before:
            Color:
                rgb: parse_color('#262625')
            Rectangle:
                size: self.size
                pos: self.pos

        MDBoxLayout:
            adaptive_height: True
            padding: dp(8), dp(6)
            radius: [18,]
            canvas.before:
                Color:
                    rgb: parse_color('#dfcaeb')
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: [18, 18, 18, 18]

            MDLabel:
                text: "Voice Input (Offline)"
                bold: True
                halign: "left"
                theme_text_color: "Custom"
                text_color: parse_color("#1f1f1f")

        MDLabel:
            text: "Tip: speak close to mic, short sentences."
            font_style: "Caption"
            theme_text_color: "Custom"
            text_color: parse_color("#bbbbbb")
            halign: "left"

        MDScrollView:
            canvas.before:
                Color:
                    rgb: parse_color('#1f1f1f')
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: [16, 16, 16, 16]

            MDLabel:
                text: root.transcript if root.transcript else "Tap Start"
                padding: dp(12), dp(12)
                size_hint_y: None
                height: self.texture_size[1] + dp(24)
                theme_text_color: "Custom"
                text_color: parse_color("#f7f7f5")
                halign: "left"
                valign: "top"

        MDBoxLayout:
            adaptive_height: True
            spacing: dp(10)

            MDFillRoundFlatIconButton:
                icon: "microphone"
                text: "Start / Stop"
                md_bg_color: "#333036"
                on_release: root.toggle_listen()

            MDFillRoundFlatIconButton:
                icon: "send"
                text: "Send to Chat"
                md_bg_color: "#333036"
                on_release: root.send_to_chat()


<CameraScreen>:
    MDBoxLayout:
        orientation: "vertical"
        padding: dp(12)
        spacing: dp(10)
        canvas.before:
            Color:
                rgb: parse_color('#262625')
            Rectangle:
                size: self.size
                pos: self.pos

        MDBoxLayout:
            adaptive_height: True
            padding: dp(8), dp(6)
            canvas.before:
                Color:
                    rgb: parse_color('#dfcaeb')
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: [18, 18, 18, 18]

            MDLabel:
                text: "OCR (Offline)"
                bold: True
                halign: "left"
                theme_text_color: "Custom"
                text_color: parse_color("#1f1f1f")

        MDLabel:
            text: "Best capture: keep paper flat, camera parallel, good light, fill frame with text. Long page: 2-3 photos (top/mid/bottom)."
            font_style: "Caption"
            theme_text_color: "Custom"
            text_color: parse_color("#bbbbbb")
            halign: "left"

        MDScrollView:
            canvas.before:
                Color:
                    rgb: parse_color('#1f1f1f')
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: [16, 16, 16, 16]

            MDLabel:
                text: root.ocr_text
                padding: dp(12), dp(12)
                size_hint_y: None
                height: self.texture_size[1] + dp(24)
                theme_text_color: "Custom"
                text_color: parse_color("#f7f7f5")
                halign: "left"
                valign: "top"

        MDBoxLayout:
            adaptive_height: True
            spacing: dp(10)

            MDFillRoundFlatIconButton:
                icon: "image"
                text: "Pick Image"
                md_bg_color: "#333036"
                on_release: root.pick_image()

            MDFillRoundFlatIconButton:
                icon: "content-copy"
                text: "Copy"
                md_bg_color: "#333036"
                on_release: app.inject_text_to_chat(root.ocr_text, auto_send=False)

            MDFillRoundFlatIconButton:
                icon: "send"
                text: "Send"
                md_bg_color: "#333036"
                on_release: root.send_to_chat()


<DocsScreen>:
    MDBoxLayout:
        orientation: "vertical"
        padding: dp(12)
        spacing: dp(10)
        canvas.before:
            Color:
                rgb: parse_color('#262625')
            Rectangle:
                size: self.size
                pos: self.pos

        MDBoxLayout:
            adaptive_height: True
            padding: dp(8), dp(6)
            canvas.before:
                Color:
                    rgb: parse_color('#dfcaeb')
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: [18, 18, 18, 18]

            MDLabel:
                text: "Documents (RAG)"
                bold: True
                halign: "left"
                theme_text_color: "Custom"
                text_color: parse_color("#1f1f1f")

        MDLabel:
            text: root.status
            theme_text_color: "Custom"
            text_color: parse_color("#f7f7f5")
            halign: "left"

        MDBoxLayout:
            adaptive_height: True
            spacing: dp(10)

            MDFillRoundFlatIconButton:
                icon: "file-document"
                text: "Pick PDF/DOCX/TXT"
                md_bg_color: "#333036"
                on_release: root.pick_document()

            MDFillRoundFlatIconButton:
                icon: "chat"
                text: "Back to Chat"
                md_bg_color: "#333036"
                on_release: root.go_chat()
